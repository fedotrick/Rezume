# Неделя 4: Оптимизация и .NET интеграция

## Обзор недели

Четвёртая неделя посвящена повышению производительности SQL Server, чтению и интерпретации планов выполнения, работе с большими объёмами финансовых данных и интеграции базы с приложениями на платформе .NET. Вы научитесь выявлять «узкие места» в запросах, применять техники оптимизации для наборов данных объёмом 10+ миллионов строк, а также выстраивать надёжную интеграцию с C#-приложениями и ETL-пайплайнами.

## Структура материалов

| Категория | Описание | Файлы |
|-----------|----------|-------|
| **Лекции** | Пошаговые конспекты по работе с execution plan, оптимизации больших запросов, интеграции ADO.NET/EF, а также краткий экскурс в финансовую предметную область | `lectures/Lecture1_Execution_Plan_Analysis.md`<br>`lectures/Lecture2_Query_Optimization_Big_Data.md`<br>`lectures/Lecture3_DotNet_SQL_Server.md`<br>`lectures/Lecture4_Financial_Market_Fundamentals.md` |
| **Практические задачи** | 5 заданий с пошаговыми инструкциями, шаблонами измерений и эталонными результатами | `practical-tasks/Task1_Slow_Query_Analysis.md`<br>`practical-tasks/Task2_Big_Data_Processing.md`<br>`practical-tasks/Task3_DotNet_Integration.md`<br>`practical-tasks/Task4_Financial_ETL_Pipeline.md`<br>`practical-tasks/Task5_Portfolio_Report.md` |
| **SQL- и .NET-скрипты** | Набор эталонных запросов, шаблонов индексирования, примеров partitioning и образцы кода C# для работы с SQL Server | `scripts/week4_optimization_examples.sql`<br>`scripts/Week4_DotNet_Integration_Samples.cs` |
| **Best Practices** | Методические рекомендации по профилированию, оптимизации, развёртыванию и сопровождению решений в production | `BEST_PRACTICES_AND_RECOMMENDATIONS.md` |

## Основные результаты обучения

1. **Анализ execution plan**: понимание операторов (Index Seek, Hash Join, Nested Loops), метрик стоимости и выбор оптимальной стратегии индексации.
2. **Оптимизация массивных запросов**: использование партиционирования, batch-обработки, columnstore-индексов и BULK-операций.
3. **Интеграция с .NET**: работа с ADO.NET, Entity Framework Core, connection pooling, обработка ошибок и профилирование производительности.
4. **Построение ETL-процессов** для финансовых данных с валидацией, расчётом метрик и оптимизацией загрузки.
5. **Финансовая предметная область**: ключевые метрики, расчёт доходности, волатильности и структуры портфеля средствами SQL.

## Рекомендуемая последовательность

1. Изучите лекции в заданном порядке, повторяя примеры на собственном стенде.
2. Выполните практические задания, опираясь на шаблоны из каталога `scripts/`.
3. Сравните свои решения с эталонными примерами и рекомендациями.
4. Ознакомьтесь с Best Practices перед внедрением решений в production.

## Предварительные требования

- Уверенное владение материалами недель 1-3 (базовый SQL, оптимизация запросов, процедуры, триггеры).
- SQL Server 2019+ или Azure SQL Database с правами администратора.
- Установленная Visual Studio / Rider или .NET SDK 6+ для примеров интеграции.

## Практическая лаборатория

Учебные данные и примеры сосредоточены вокруг финансовых транзакций, портфелей и отчётности. Скрипт `week4_optimization_examples.sql` разворачивает базу примеров и содержит последовательность шагов по оптимизации. C#-файл демонстрирует, как безопасно и эффективно взаимодействовать с SQL Server из .NET-приложений, выполнять хранимые процедуры и собирать метрики.

## Связанные материалы

- Неделя 1: `/week1-sqlserver-basics`
- Неделя 2: `/week2-advanced-sql-queries`
- Неделя 3: `/week3-procedures-triggers-tsql`

## Обратная связь

Сообщайте о найденных неточностях или предлагайте улучшения через issue/PR. Чем больше практики и обратной связи, тем надёжнее ваши production-решения.
